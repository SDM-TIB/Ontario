@prefix rr: <http://www.w3.org/ns/r2rml#> .
@prefix rml: <http://semweb.mmlab.be/ns/rml#> .
@prefix ql: <http://semweb.mmlab.be/ns/ql#> .
@prefix rdfs: <http://www.w3.org/2000/01/rdf-schema#> .
@prefix rdf: <http://www.w3.org/1999/02/22-rdf-syntax-ns#> .
@prefix rev: <http://purl.org/stuff/rev#> .
@prefix schema: <http://schema.org/> .
@prefix xsd: <http://www.w3.org/2001/XMLSchema#> .
@prefix : <http://tib.de/ontario/mapping#> .
@prefix owl: <http://www.w3.org/2002/07/owl#> .
@prefix drugbank: <http://drugbank.ca/vocab/> .
@prefix foaf: <http://xmlns.com/foaf/0.1/> .


###############################################
############### Drug ##########################
##############################################
:drugbank_drug
  	rml:logicalSource [
              rml:source "drugbank.xml";
  						rml:referenceFormulation ql:XPath;
                        rml:iterator "/drugbank/drug"
  						];
  	rr:subjectMap [
  		      rr:template "http://drugbank.ca/Drug/{drugbank-id[*][_primary=true]}";
        		rr:class drugbank:Drug
  	];
    rr:predicateObjectMap [
      rr:predicate drugbank:name;
      rr:objectMap [
        rml:reference "name"
      ]
    ];
    rr:predicateObjectMap [
      rr:predicate drugbank:description;
      rr:objectMap [
        rml:reference "description"
      ]
    ];
    rr:predicateObjectMap [
      rr:predicate drugbank:casNumber;
      rr:objectMap [
        rml:reference "cas-number"
      ]
    ];
    rr:predicateObjectMap [
      rr:predicate drugbank:unii;
      rr:objectMap [
        rml:reference "unii"
      ]
    ];
    rr:predicateObjectMap [
      rr:predicate drugbank:metabolism;
      rr:objectMap [
        rml:reference "metabolism"
      ]
    ];
    rr:predicateObjectMap [
      rr:predicate drugbank:routeOfElimination;
      rr:objectMap [
        rml:reference "route-of-elimination"
      ]
    ];
    rr:predicateObjectMap [
      rr:predicate drugbank:volumeOfDistribution;
      rr:objectMap [
        rml:reference "volume-of-distribution"
      ]
    ];
    rr:predicateObjectMap [
      rr:predicate drugbank:state;
      rr:objectMap [
        rml:reference "state"
      ]
    ];
    rr:predicateObjectMap [
      rr:predicate drugbank:indication;
      rr:objectMap [
        rml:reference "indication"
      ]
    ];
    rr:predicateObjectMap [
      rr:predicate drugbank:toxicity;
      rr:objectMap [
        rml:reference "toxicity"
      ]
    ];
  	rr:predicateObjectMap [
      		rr:predicate drugbank:drugType;
          rr:objectMap [
            rml:reference "_type"
          ]
  	];
    rr:predicateObjectMap [
      rr:predicate drugbank:pharmacology;
      rr:objectMap [
        rml:reference "pharmacodynamics"
      ]
    ];
    rr:predicateObjectMap [
      rr:predicate drugbank:mechanismOfAction;
      rr:objectMap [
        rml:reference "mechanism-of-action"
      ]
    ];
    rr:predicateObjectMap [
      rr:predicate drugbank:absorption;
      rr:objectMap [
        rml:reference "absorption"
      ]
    ];
    rr:predicateObjectMap [
      rr:predicate drugbank:halfLife;
      rr:objectMap [
        rml:reference "half-life"
      ]
    ];
    rr:predicateObjectMap [
      rr:predicate drugbank:clearance;
      rr:objectMap [
        rml:reference "clearance"
      ]
    ];
    rr:predicateObjectMap [
      rr:predicate drugbank:updateDate;
      rr:objectMap [
        rml:reference "_updated"
      ]
    ];
    rr:predicateObjectMap [
      rr:predicate drugbank:creationDate;
      rr:objectMap [
        rml:reference "_created"
      ]
    ];
    rr:predicateObjectMap [
      rr:predicate rdfs:label;
      rr:objectMap [
        rml:reference "name"
      ]
    ];
    rr:predicateObjectMap [
      rr:predicate foaf:page;
      rr:objectMap [
        rr:template "http://www.drugbank.ca/drugs/{drugbank-id[*][_primary=true]}"
      ]
    ];
    rr:predicateObjectMap [
      rr:predicate owl:sameAs;
      rr:objectMap [
        rr:template "http://www4.wiwiss.fu-berlin.de/drugbank/resource/drugs/{drugbank-id[*][_primary=true]}";
        rr:class <http://www4.wiwiss.fu-berlin.de/drugbank/resource/drugbank/drugs>
      ]
    ];
    rr:predicateObjectMap [
      rr:predicate drugbank:synonym;
      rr:objectMap [
        rml:reference "synonyms/synonym[*]/_VALUE"
      ]
    ];
    rr:predicateObjectMap [
      rr:predicate drugbank:averageMass;
      rr:objectMap [
        rml:reference "average-mass"
      ]
    ];
    rr:predicateObjectMap [
      rr:predicate drugbank:foodInteraction;
      rr:objectMap [
         rml:reference  "food-interactions/food-interaction[*]"
      ]
    ];
    #####################################
    ################ External Identifiers
    #####################################
    rr:predicateObjectMap [
      rr:predicate drugbank:pharmgkbId;
      rr:objectMap [
         rml:reference  "external-identifiers/external-identifier[*][resource=PharmGKB]/identifier"
      ]
    ];
    rr:predicateObjectMap [
      rr:predicate drugbank:dpdDrugIdNumber;
      rr:objectMap [
         rml:reference  "external-identifiers/external-identifier[*][resource=Drugs Product Database (DPD)]/identifier"
      ]
    ];
    rr:predicateObjectMap [
      rr:predicate drugbank:pubchemCompoundId;
      rr:objectMap [
         rml:reference  "external-identifiers/external-identifier[*][resource=PubChem Compound]/identifier"
      ]
    ];
    rr:predicateObjectMap [
      rr:predicate drugbank:pubchemSubstanceId;
      rr:objectMap [
         rml:reference  "external-identifiers/external-identifier[*][resource=PubChem Substance]/identifier"
      ]
    ];
    rr:predicateObjectMap [
      rr:predicate drugbank:uniprotId;
      rr:objectMap [
         rml:reference  "external-identifiers/external-identifier[*][resource=UniProtKB]/identifier"
      ]
    ];
    rr:predicateObjectMap [
      rr:predicate drugbank:ttdId;
      rr:objectMap [
         rml:reference  "external-identifiers/external-identifier[*][resource=Therapeutic Targets Database]/identifier"
      ]
    ];
    rr:predicateObjectMap [
      rr:predicate drugbank:keggDrugId;
      rr:objectMap [
         rr:template  "http://bio2rdf.org/kegg:{external-identifiers/external-identifier[*][resource=KEGG Drug]/identifier}"
      ]
    ];
    rr:predicateObjectMap [
      rr:predicate drugbank:wikipediaId;
      rr:objectMap [
         rml:reference  "external-identifiers/external-identifier[*][resource=Wikipedia]/identifier"
      ]
    ];
    rr:predicateObjectMap [
      rr:predicate drugbank:chemblId;
      rr:objectMap [
         rml:reference  "external-identifiers/external-identifier[*][resource=ChEMBL]/identifier"
      ]
    ];
    rr:predicateObjectMap [
      rr:predicate drugbank:chebiId;
      rr:objectMap [
         rml:reference  "external-identifiers/external-identifier[*][resource=ChEBI]/identifier"
      ]
    ];
    rr:predicateObjectMap [
      rr:predicate drugbank:genbankId;
      rr:objectMap [
         rml:reference  "external-identifiers/external-identifier[*][resource=GenBank Gene Database]/identifier"
      ]
    ];
    rr:predicateObjectMap [
      rr:predicate drugbank:keggCompoundId;
      rr:objectMap [
         rr:template  "http://bio2rdf.org/cpd:{external-identifiers/external-identifier[*][resource=KEGG Compound]/identifier}"
      ]
    ];

    ################################################
    ############
    ################################################
    rr:predicateObjectMap [
      rr:predicate drugbank:reference;
      rr:objectMap [
        rr:parentTriplesMap :drugbank_drug_article_reference
      ]
    ];

    rr:predicateObjectMap [
      rr:predicate drugbank:enzyme;
      rr:objectMap [
        rr:parentTriplesMap :drugbank_drug_enzyme
      ]
    ];
    rr:predicateObjectMap [
      rr:predicate drugbank:target;
      rr:objectMap [
        rr:parentTriplesMap :drugbank_drug_target
      ]
    ];

    rr:predicateObjectMap [
      rr:predicate drugbank:transporter;
      rr:objectMap [
        rr:parentTriplesMap :drugbank_drug_transporter
      ]
    ];
    rr:predicateObjectMap [
      rr:predicate drugbank:carrier;
      rr:objectMap [
        rr:parentTriplesMap :drugbank_drug_carrier
      ]
    ].

###############################################
############### Drug Interaction #############
##############################################
:drugbank_drug_drug_interaction
      rml:logicalSource [
                rml:source "drugbank.xml";
                rml:referenceFormulation ql:XPath;
                rml:iterator "/drugbank/drug"
                ];
      rr:subjectMap [
              rr:template "http://drugbank.ca/DrugInteraction/{drugbank-id[@primary=true]}_{drug-interactions/drug-interaction[*]/drugbank-id}";
              rr:class drugbank:DrugInteraction
      ];
      rr:predicateObjectMap [
        rr:predicate drugbank:drug2;
        rr:objectMap [
          rr:template  "http://drugbank.ca/Drug/{drug-interactions/drug-interaction[*]/drugbank-id}"
        ]
      ];
      rr:predicateObjectMap [
        rr:predicate drugbank:drug1;
        rr:objectMap [
          rr:template  "http://drugbank.ca/Drug/{drugbank-id[@primary=true]}"
        ]
      ];
      rr:predicateObjectMap [
        rr:predicate drugbank:name;
        rr:objectMap [
          rml:reference "drug-interactions/drug-interaction[*]/name"
        ]
      ];
      rr:predicateObjectMap [
        rr:predicate drugbank:description;
        rr:objectMap [
          rml:reference "drug-interactions/drug-interaction[*]/description"
        ]
      ].


###############################################
############### drug Reference ###############
##############################################
:drugbank_drug_article_reference
      rml:logicalSource [
                rml:source "drugbank.xml";
                rml:referenceFormulation ql:XPath;
                rml:iterator "/drugbank/drug"
                ];
      rr:subjectMap [
              rr:template "http://drugbank.ca/ArticleReference/{general-references/articles.article[*]/pubmed-id}";
              rr:class drugbank:ArticleReference
      ];
      rr:predicateObjectMap [
        rr:predicate drugbank:pubmedId;
        rr:objectMap [
          rml:reference "general-references/articles.article[*]/pubmed-id"
        ]
      ];
      rr:predicateObjectMap [
        rr:predicate drugbank:title;
        rr:objectMap [
          rml:reference "general-references/articles.article[*]/citation"
        ]
      ].

########################################
########### Target ###################
#######################################
:drugbank_drug_target
        rml:logicalSource [
                  rml:source "drugbank.xml";
                  rml:referenceFormulation ql:XPath;
                  rml:iterator "/drugbank/drug/targets/target"
                  ];
        rr:subjectMap [
                rr:template "http://drugbank.ca/Target/{id}";
                rr:class drugbank:Target
        ];
        rr:predicateObjectMap [
          rr:predicate drugbank:name;
          rr:objectMap [
            rml:reference "name"
          ]
        ];
        rr:predicateObjectMap [
          rr:predicate drugbank:organism;
          rr:objectMap [
            rml:reference "organism"
          ]
        ];
        rr:predicateObjectMap [
          rr:predicate drugbank:protein;
          rr:objectMap [
            rr:parentTriplesMap :drugbank_drug_target_polypeptide
          ]
        ];
        rr:predicateObjectMap [
          rr:predicate drugbank:reference;
          rr:objectMap [
            rr:parentTriplesMap :drugbank_target_article_reference
          ]
        ];
        rr:predicateObjectMap [
          rr:predicate drugbank:reference;
          rr:objectMap [
            rr:parentTriplesMap :drugbank_target_link_reference
          ]
        ];
        rr:predicateObjectMap [
          rr:predicate drugbank:reference;
          rr:objectMap [
            rr:parentTriplesMap :drugbank_target_textbook_reference
          ]
        ];
        rr:predicateObjectMap [
          rr:predicate drugbank:action;
          rr:objectMap [
            rml:reference "actions/action[*]"
          ]
        ].

###############################################
############### Polypeptide #####################
##############################################
:drugbank_drug_target_polypeptide
    rml:logicalSource [
              rml:source "drugbank.xml";
              rml:referenceFormulation ql:XPath;
              rml:iterator "/drugbank/drug/targets/target/polypeptide"
              ];
    rr:subjectMap [
            rr:template "http://drugbank.ca/Protein/{_id}";
            rr:class drugbank:Protein
    ];
    rr:predicateObjectMap [
      rr:predicate drugbank:name;
      rr:objectMap [
        rml:reference "name"
      ]
    ];
    rr:predicateObjectMap [
      rr:predicate drugbank:source;
      rr:objectMap [
        rml:reference "_source"
      ]
    ];
    rr:predicateObjectMap [
      rr:predicate drugbank:swissprotId;
      rr:objectMap [
        rr:template "http://www.uniprot.org/uniprot/{_id}"
      ]
    ];
    rr:predicateObjectMap [
      rr:predicate drugbank:swissprotPage;
      rr:objectMap [
        rr:template "http://bio2rdf.org/uniprot:{_id}"
      ]
    ];
    rr:predicateObjectMap [
      rr:predicate drugbank:swissprotName;
      rr:objectMap [
        rml:reference "name}"
      ]
    ];
    rr:predicateObjectMap [
      rr:predicate drugbank:generalFunction;
      rr:objectMap [
        rml:reference "general-function"
      ]
    ];
    rr:predicateObjectMap [
      rr:predicate drugbank:specificFunction;
      rr:objectMap [
        rml:reference "specific-function"
      ]
    ];
    rr:predicateObjectMap [
      rr:predicate drugbank:locus;
      rr:objectMap [
        rml:reference "locus"
      ]
    ];
    rr:predicateObjectMap [
      rr:predicate drugbank:cellularLocation;
      rr:objectMap [
        rml:reference "cellular-location"
      ]
    ];
    rr:predicateObjectMap [
      rr:predicate drugbank:signal;
      rr:objectMap [
        rml:reference "signal-regions"
      ]
    ];
    rr:predicateObjectMap [
      rr:predicate drugbank:theoreticalPi;
      rr:objectMap [
        rml:reference "theoretical-pi"
      ]
    ];
    rr:predicateObjectMap [
      rr:predicate drugbank:molecularWeight;
      rr:objectMap [
        rml:reference "molecular-weight"
      ]
    ];
    rr:predicateObjectMap [
      rr:predicate drugbank:chromosomeLocation;
      rr:objectMap [
        rml:reference "chromosome-location"
      ]
    ];
    rr:predicateObjectMap [
      rr:predicate drugbank:proteinSequence;
      rr:objectMap [
        rml:reference "amino-acid-sequence[*]/_VALUE"
      ]
    ];
    rr:predicateObjectMap [
      rr:predicate drugbank:goClassificationComponent;
      rr:objectMap [
        rml:reference "go-classifiers/go-classifier[*][category=component]/description"
      ]
    ];
    rr:predicateObjectMap [
      rr:predicate drugbank:goClassificationProcess;
      rr:objectMap [
        rml:reference "go-classifiers/go-classifier[*][category=process]/description"
      ]
    ];
    rr:predicateObjectMap [
      rr:predicate drugbank:goClassificationFunction;
      rr:objectMap [
        rml:reference "go-classifiers/go-classifier[*][category=function]/description"
      ]
    ];
    rr:predicateObjectMap [
      rr:predicate drugbank:pfamDomainFunction;
      rr:objectMap [
        rr:template "http://bio2rdf.org/pfam:{pfams/pfam[*]/identifier}"
      ]
    ];
    rr:predicateObjectMap [
      rr:predicate drugbank:pfamDomainFunctionPage;
      rr:objectMap [
        rr:template "http://pfam.sanger.ac.uk/family?acc={pfams/pfam[*]/identifier}"
      ]
    ];
    rr:predicateObjectMap [
      rr:predicate drugbank:synonym;
      rr:objectMap [
        rml:reference "synonyms/synonym[*]"
      ]
    ];
    rr:predicateObjectMap [
      rr:predicate drugbank:transmembraneRegions;
      rr:objectMap [
        rml:reference "transmembrane-regions"
      ]
    ];
    rr:predicateObjectMap [
      rr:predicate drugbank:organism;
      rr:objectMap [
        rr:parentTriplesMap :drugbank_target_organism
      ]
    ];
    ######################################################################
    ########### External identifiers ####################################
    #####################################################################
    rr:predicateObjectMap [
      rr:predicate drugbank:hgncId;
      rr:objectMap [
        rml:reference "external-identifiers/external-identifier[*][resource=HUGO Gene Nomenclature Committee (HGNC)]/identifier"
      ]
    ];
    rr:predicateObjectMap [
      rr:predicate drugbank:genatlasId;
      rr:objectMap [
        rml:reference "external-identifiers/external-identifier[*][resource=GenAtlas]/identifier"
      ]
    ];
    rr:predicateObjectMap [
      rr:predicate drugbank:genbankIdGene;
      rr:objectMap [
        rml:reference "external-identifiers/external-identifier[*][resource=GenBank Gene Database]/identifier"
      ]
    ];
    rr:predicateObjectMap [
      rr:predicate drugbank:genbankIdProtein;
      rr:objectMap [
        rml:reference "external-identifiers/external-identifier[*][resource=GenBank Protein Database]/identifier"
      ]
    ];
    rr:predicateObjectMap [
      rr:predicate drugbank:uniprotId;
      rr:objectMap [
        rml:reference "external-identifiers/external-identifier[*][resource=UniProtKB]/identifier"
      ]
    ];
    rr:predicateObjectMap [
      rr:predicate drugbank:uniprotAccession;
      rr:objectMap [
        rml:reference "external-identifiers/external-identifier[*][resource=UniProt Accession]/identifier"
      ]
    ];

    rr:predicateObjectMap [
      rr:predicate drugbank:gene;
      rr:objectMap [
        rr:parentTriplesMap :drugbank_target_gene
      ]
    ].

###############################################
############### Organism #####################
##############################################
:drugbank_target_organism
    rml:logicalSource [
              rml:source "drugbank.xml";
              rml:referenceFormulation ql:XPath;
              rml:iterator "/drugbank/drug/targets/target/polypeptide/organism"
              ];
    rr:subjectMap [
            rr:template "http://drugbank.ca/Organism/{_ncbi-taxonomy-id}";
            rr:class drugbank:Organism
    ];
    rr:predicateObjectMap [
      rr:predicate drugbank:name;
      rr:objectMap [
        rml:reference "_VALUE"
      ]
    ];
    rr:predicateObjectMap [
      rr:predicate drugbank:ncbiTaxonomyId;
      rr:objectMap [
        rml:reference "_ncbi-taxonomy-id"
      ]
    ].

###############################################
############### Gene #########################
##############################################
:drugbank_target_gene
    rml:logicalSource [
              rml:source "drugbank.xml";
              rml:referenceFormulation ql:XPath;
              rml:iterator "/drugbank/drug/targets/target/polypeptide"
              ];
    rr:subjectMap [
            rr:template "http://drugbank.ca/Gene/{gene-name}";
            rr:class drugbank:Gene
    ];
    rr:predicateObjectMap [
      rr:predicate drugbank:name;
      rr:objectMap [
        rml:reference "gene-name"
      ]
    ];
    rr:predicateObjectMap [
      rr:predicate drugbank:geneSequence;
      rr:objectMap [
        rml:reference "gene-sequence[*]/_VALUE"
      ]
    ];
    rr:predicateObjectMap [
      rr:predicate drugbank:action;
      rr:objectMap [
        rml:reference "actions/action[*]"
      ]
    ].
